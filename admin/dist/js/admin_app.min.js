"use strict";function checkdate(e,t){var o=new Date(e),s=new Date(t),a=new Date;return moment().range(o,s).contains(a)}function chat_options(){return{type:"serial",pathToImages:"assets/img/",theme:"light",dataDateFormat:"YYYY-MM-DD",precision:2,chartScrollbar:{graph:"g1",oppositeAxis:!1,offset:30,scrollbarHeight:50,backgroundAlpha:0,selectedBackgroundAlpha:.1,selectedBackgroundColor:"#888888",graphFillAlpha:0,graphLineAlpha:.5,selectedGraphFillAlpha:0,selectedGraphLineAlpha:1,autoGridCount:!0,color:"#AAAAAA"},chartCursor:{pan:!0,valueLineEnabled:!0,valueLineBalloonEnabled:!0,cursorAlpha:0,valueLineAlpha:.2},categoryField:"date",categoryAxis:{parseDates:!0,dashLength:1,minorGridEnabled:!0},legend:{useGraphSettings:!0,position:"top"},balloon:{borderThickness:1,shadowAlpha:0}}}function formatted_address(e){if(!angular.isArray(e))return e+" is not an array";var t={};return e.length>7?t.address=[e[0].long_name,e[1].long_name,e[2].long_name].join(" "):t.address=[e[0].long_name,e[1].long_name].join(" "),e.map(function(e){e.types.indexOf("locality")>-1&&(t.city=e.long_name),(e.types.indexOf("administrative_area_level_1")>-1||e.types.indexOf("administrative_area_level_2")>-1)&&(t.state=e.long_name),e.types.indexOf("country")>-1&&(t.country=e.long_name),e.types.indexOf("postal_code")>-1&&(t.postal_code=e.long_name)}),t}function passwordVerify(){function e(e,t,o,s){e.$watch(function(){var t;return(e.passwordVerify||s)&&(t=e.passwordVerify+"_"+s),t},function(t){t&&(s.$validators.passwordVerify=function(t){return e.passwordVerify===t})})}return{require:"ngModel",scope:{passwordVerify:"="},link:e}}var app=angular.module("myAdminApp",["ngRoute","ngMaterial","ngMessages","ui.bootstrap","ngFileUpload","ngImgCrop","angular-loading-bar","md.data.table","ngCookies","LocalStorageModule","summernote","ngSlimScroll"]);app.constant("api_path","/admin_api/"),"localhost:8017"==window.location.host?app.constant("socketURL","http://100.100.7.39:8025/"):app.constant("socketURL","http://158.85.75.204:8025/"),app.config(["localStorageServiceProvider",function(e){e.setPrefix("TASKYGIG-ADMIN")}]).config(["$httpProvider",function(e){e.interceptors.push(["$q","$rootScope","localStorageService",function(e,t,o){return{request:function(t){t.headers=t.headers||{};var s=o.cookie.get("user");return s&&(s=s.token,t.headers.Authorization="Bearer "+s),t||e.when(t)},response:function(t){return t||e.when(t)},responseError:function(o){return 401===o.status&&t.removeSession(),o||e.when(o)}}}])}]).config(["$mdThemingProvider",function(e){e.theme("error"),e.theme("success")}]).run(["$rootScope","$location","$timeout","cfpLoadingBar","$mdDialog","Toaster",function(e,t,o,s,a,n){e.isLogin=n.getSession(),e.selected=[],e.loader=!1,e.limitOptions=[10,20,50],e.query={order:"_id",limit:10,page:1},e.$on("$routeChangeSuccess",function(a,n,i){e.selected=[],e.q="",delete e.query.type,e.checkRole(n.$$route.accessLevel)||t.path("/"),["/login","/reset-password"].indexOf(t.path())>=0?e.headerAndSidebar=!1:e.headerAndSidebar=!0,s.start(),o(function(){s.complete()},2e3),$("html,body").animate({scrollTop:0},500)}),e.$on("$routeChangeError",function(e,o,s,a){!0===a.authentication?t.path("/dashboard"):t.path("/login")}),e.$on("$locationChangeSuccess",function(e,o,s){var a=s.substr(0,s.indexOf("?"));a!==o.substr(0,o.indexOf("?"))&&a.length>0&&t.search("")}),e.$on("$routeChangeStart",function(){"/login"==t.path()?e.adminLoginPage=!0:e.adminLoginPage=!1}),e.go=function(e){if(e.indexOf("?")>=0){var o=e.split("?"),s=o[1].split("=");t.path(o[0]).search(s[0],s[1])}else t.path(e)},e.closeDialog=function(){a.hide()},e.logout=function(t){n.confirm({title:"Do you really want to logout?",message:"You can ternimate your session",event:t||""}).then(function(){e.removeSession()},function(){})},e.removeSession=function(){localStorage.removeItem("token"),n.removeSession(),delete e.isLogin,t.path("/login")},e.checkRole=function(t){if(!t)return!0;var o={};return o.userRole=e.isLogin.user.type,o.status=!1,t&&angular.forEach(t,function(e){t.indexOf(o.userRole)>=0&&(o.status=!0)}),o.status}}]),app.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"backend/dashboard/views/dashboard.html",controller:"DashboardController",resolve:{validate:required}}).when("/login",{templateUrl:"backend/landing/views/admin_login.html",controller:"authController",resolve:{validate:notRequired}}).when("/reset-password",{templateUrl:"backend/landing/views/reset.html",controller:"authController",resolve:{validate:notRequired}}).when("/profile",{templateUrl:"backend/profile/views/profile.html",controller:"ProfileController",resolve:{validate:required}}).when("/settings",{templateUrl:"backend/settings/views/index.html",controller:"SettingController",resolve:{validate:required},accessLevel:[1]}).when("/settings",{templateUrl:"backend/settings/views/index.html",controller:"SettingController",resolve:{validate:required},accessLevel:[1]}).when("/settings/site-config",{templateUrl:"backend/settings/views/conf.html",controller:"SettingController",resolve:{validate:required},accessLevel:[1]}).when("/managers",{templateUrl:"backend/managers/views/index.html",controller:"ManagerController",resolve:{validate:required},accessLevel:[1]}).when("/managers/add",{templateUrl:"backend/managers/views/add.html",controller:"ManagerController",resolve:{validate:required},accessLevel:[1]}).when("/managers/edit/:manager_id",{templateUrl:"backend/managers/views/edit.html",controller:"EditManagerController",resolve:{validate:required},accessLevel:[1]}).when("/pages",{templateUrl:"backend/pages/views/index.html",controller:"PageController",resolve:{validate:required}}).when("/pages/add",{templateUrl:"backend/pages/views/add.html",controller:"AddPageController",resolve:{validate:required}}).when("/pages/edit/:post_id",{templateUrl:"backend/pages/views/edit.html",controller:"EditPageController",resolve:{validate:required}}).when("/links",{templateUrl:"backend/links/views/index.html",controller:"LinkController",resolve:{validate:required}}).when("/links/add",{templateUrl:"backend/links/views/add.html",controller:"AddLinkController",resolve:{validate:required}}).when("/links/edit/:post_id",{templateUrl:"backend/links/views/edit.html",controller:"EditLinkController",resolve:{validate:required}}).when("/slider",{templateUrl:"backend/slider/views/index.html",controller:"SliderController",resolve:{validate:required}}).when("/slider/add",{templateUrl:"backend/slider/views/add.html",controller:"AddSliderController",resolve:{validate:required}}).when("/slider/edit/:post_id",{templateUrl:"backend/slider/views/edit.html",controller:"EditSliderController",resolve:{validate:required}}).when("/blogs",{templateUrl:"backend/blogs/views/index.html",controller:"BlogController",resolve:{validate:required}}).when("/blogs/add",{templateUrl:"backend/blogs/views/add.html",controller:"AddBlogController",resolve:{validate:required}}).when("/blogs/edit/:post_id",{templateUrl:"backend/blogs/views/edit.html",controller:"EditBlogController",resolve:{validate:required}}).when("/benefits",{templateUrl:"backend/benefits/views/index.html",controller:"BenefitController",resolve:{validate:required}}).when("/benefits/add",{templateUrl:"backend/benefits/views/add.html",controller:"AddBenefitController",resolve:{validate:required}}).when("/benefits/edit/:post_id",{templateUrl:"backend/benefits/views/edit.html",controller:"EditBenefitController",resolve:{validate:required}}).when("/blocks",{templateUrl:"backend/blocks/views/index.html",controller:"BlockController",resolve:{validate:required}}).when("/blocks/add",{templateUrl:"backend/blocks/views/add.html",controller:"AddBlockController",resolve:{validate:required}}).when("/blocks/edit/:post_id",{templateUrl:"backend/blocks/views/edit.html",controller:"EditBlockController",resolve:{validate:required}}).when("/testimonials",{templateUrl:"backend/testimonials/views/index.html",controller:"TestimonialController",resolve:{validate:required}}).when("/testimonials/add",{templateUrl:"backend/testimonials/views/add.html",controller:"AddTestimonialController",resolve:{validate:required}}).when("/testimonials/edit/:post_id",{templateUrl:"backend/testimonials/views/edit.html",controller:"EditTestimonialController",resolve:{validate:required}}).when("/community",{templateUrl:"backend/community/views/index.html",controller:"CommunityController",resolve:{validate:required}}).when("/community/add",{templateUrl:"backend/community/views/add.html",controller:"AddCommunityController",resolve:{validate:required}}).when("/community/edit/:post_id",{templateUrl:"backend/community/views/edit.html",controller:"EditCommunityController",resolve:{validate:required}}).when("/jobs",{templateUrl:"backend/jobs/views/index.html",controller:"JobsController",resolve:{validate:required},accessLevel:[1,2]}).when("/jobs/details/:id",{templateUrl:"backend/jobs/views/details.html",controller:"JobsController",resolve:{validate:required},accessLevel:[1,2]}).when("/payments",{templateUrl:"backend/payments/views/index.html",controller:"PaymentController",resolve:{validate:required},accessLevel:[1,2]}).when("/payments/details/:id",{templateUrl:"backend/payments/views/details.html",controller:"PaymentController",resolve:{validate:required},accessLevel:[1,2]}).when("/jobs/category",{templateUrl:"backend/jobs/category/views/index.html",controller:"JobController",resolve:{validate:required},accessLevel:[1,2]}).when("/jobs/category/add",{templateUrl:"backend/jobs/category/views/add.html",controller:"AddJobController",resolve:{validate:required},accessLevel:[1,2]}).when("/jobs/category/edit/:post_id",{templateUrl:"backend/jobs/category/views/edit.html",controller:"EditJobController",resolve:{validate:required},accessLevel:[1,2]}).when("/jobs/category/sub-category/:post_id",{templateUrl:"backend/jobs/category/views/sub_category.html",controller:"EditJobController",resolve:{validate:required},accessLevel:[1,2]}).when("/feedbacks",{templateUrl:"backend/feedback/views/index.html",controller:"FeedbackController",resolve:{validate:required},accessLevel:[1,2]}).when("/feedbacks/view/:id",{templateUrl:"backend/feedback/views/view.html",controller:"FeedbackController",resolve:{validate:required},accessLevel:[1,2]}).when("/faq",{templateUrl:"backend/faq/views/index.html",controller:"FaqController",resolve:{validate:required}}).when("/faq/add",{templateUrl:"backend/faq/views/add.html",controller:"AddFaqController",resolve:{validate:required},accessLevel:[1,2]}).when("/faq/edit/:post_id",{templateUrl:"backend/faq/views/edit.html",controller:"EditFaqController",resolve:{validate:required},accessLevel:[1,2]}).when("/web-users",{templateUrl:"backend/webusers/views/index.html",controller:"WebUserController",resolve:{validate:required},accessLevel:[1,2]}).when("/app-users",{templateUrl:"backend/appusers/views/index.html",controller:"AppUserController",resolve:{validate:required},accessLevel:[1,2]}).when("/user/add",{templateUrl:"backend/webusers/views/addUser.html",controller:"WebUserController",resolve:{validate:required},accessLevel:[1,2]}).when("/user/details/:id",{templateUrl:"backend/webusers/views/details.html",controller:"WebUserController",resolve:{validate:required},accessLevel:[1,2]}).when("/export/:id",{templateUrl:"backend/export/views/export-result.html",controller:"ExportController",resolve:{validate:required},accessLevel:[1,2]}).when("/sitemap",{templateUrl:"backend/sitemap/views/index.html",controller:"SitemapController",resolve:{validate:required}}).when("/sitemap/add",{templateUrl:"backend/sitemap/views/add.html",controller:"AddSitemapController",resolve:{validate:required},accessLevel:[1,2]}).when("/sitemap/edit/:post_id",{templateUrl:"backend/sitemap/views/edit.html",controller:"EditSitemapController",resolve:{validate:required},accessLevel:[1,2]}).otherwise({redirectTo:"/"})}]);var required=["$q","localStorageService",function(e,t){var o=e.defer(),s=t.cookie.get("user");return s=s.token,s?o.resolve():o.reject({authentication:!1}),o.promise}],notRequired=["$q",function(e){var t=e.defer();return localStorage.getItem("token")?t.reject({authentication:!0}):t.resolve(),t.promise}];app.run(["$rootScope",function(e){e.sidenav=[{title:"Dashboard",class:"nav-item start",icon:"icon-home",link:"/",accessLevel:[1,2,3]},{title:"User Management",class:"heading",accessLevel:[1,2]},{title:"Web Users",class:"nav-item start",icon:"icon-user",link:"/web-users",accessLevel:[1,2]},{title:"App Users",class:"nav-item start",icon:"icon-user",link:"/app-users",accessLevel:[1,2]},{title:"Jobs",class:"heading",accessLevel:[1,2]},{title:"Jobs",class:"nav-item start",icon:"icon-briefcase",link:"jobs",accessLevel:[1,2]},{title:"Payments",class:"nav-item start",icon:"icon-wallet",link:"payments",accessLevel:[1,2]},{title:"CMS",class:"heading"},{title:"Pages",class:"nav-item start",icon:"icon-notebook",children:[{title:"List Pages",link:"pages",accessLevel:[1,2]},{title:"Add Page",link:"pages/add",accessLevel:[1,2]}]},{title:"Blogs",class:"nav-item start",icon:"icon-diamond",children:[{title:"List Blogs",link:"blogs",accessLevel:[1,2]},{title:"Add Blog",link:"blogs/add",accessLevel:[1,2]}]},{title:"Benefits",class:"nav-item start",icon:"icon-plus",children:[{title:"List Benefits",link:"benefits",accessLevel:[1,2]},{title:"Add Benefit",link:"benefits/add",accessLevel:[1,2]}]},{title:"CMS Block",class:"nav-item start",icon:"icon-diamond",children:[{title:"List CMS Block",link:"blocks",accessLevel:[1,2]},{title:"Add CMS Block",link:"blocks/add",accessLevel:[1,2]}]},{title:"FAQs",class:"nav-item start",icon:"icon-question",link:"faq"},{title:"Testimonials",class:"nav-item start",icon:"icon-diamond",children:[{title:"List Testimonials",link:"testimonials",accessLevel:[1,2]},{title:"Add Testimonial",link:"testimonials/add",accessLevel:[1,2]}]},{title:"Slider",class:"nav-item start",icon:"icon-picture",children:[{title:"List Slides",link:"slider",accessLevel:[1,2]},{title:"Add Slide",link:"slider/add",accessLevel:[1,2]}]},{title:"Our Community",class:"nav-item start",icon:"icon-social-dribbble",children:[{title:"List Community",link:"community",accessLevel:[1,2]},{title:"Add Community",link:"community/add",accessLevel:[1,2]}]},{title:"Social Links",class:"nav-item start",icon:"icon-social-facebook",children:[{title:"List Links",link:"links",accessLevel:[1,2]},{title:"Add Link",link:"links/add",accessLevel:[1,2]}]},{title:"Admin Users",class:"heading",accessLevel:[1,2]},{title:"All Users",class:"nav-item start",icon:"icon-user",link:"/managers",accessLevel:[1,2]},{title:"Add User",class:"nav-item start",icon:"icon-user",link:"/managers/add",accessLevel:[1,2]},{title:"Your Profile",class:"nav-item start",icon:"icon-user",link:"/profile",accessLevel:[1,2]},{title:"Tools",class:"heading",accessLevel:[1,2]},{title:"Export",class:"nav-item start",icon:"icon-user",accessLevel:[1,2],children:[{title:"Jobs",link:"/export/jobs",accessLevel:[1,2]}]},{title:"Settings",class:"heading",accessLevel:[1,2]},{title:"General",class:"nav-item start",icon:"icon-settings",link:"/settings",accessLevel:[1,2]},{title:"Application Config",class:"nav-item start",icon:"icon-settings",link:"/settings/site-config",accessLevel:[1,2]},{title:"Misc",class:"heading",accessLevel:[1,2]},{title:"Feedbacks & Queries",class:"nav-item start",icon:"icon-bubble",link:"/feedbacks",accessLevel:[1,2]},{title:"Sitemap",class:"nav-item start",icon:"icon-bubble",link:"/sitemap",accessLevel:[1,2]}]}]),app.factory("confirmationDialog",["$mdDialog",function(e){return{confirm:function(t,o){var s=e.confirm().title("Would you like to delete ?").textContent("Note: This is temporary delete. It can be restore.").targetEvent(t).ok("Ok").cancel("Cancel");o(e.show(s))}}}]),app.factory("htmlToText",[function(){return{convert:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}}}]),app.factory("REST",["$http","api_path","$rootScope",function(e,t,o){return{GET:function(s,a){return o.loader=!0,e.get(t+s,a).then(function(e){return o.loader=!1,e.data})},POST:function(s,a){return o.loader=!0,e.post(t+s,a).then(function(e){return o.loader=!1,{statusCode:e.status,output:e.data.output,message:e.data.message,success:e.data.success}},function(e){return o.loader=!1,{error:e.data}})},PUT:function(s,a){return o.loader=!0,e.put(t+s,a).then(function(e){return o.loader=!1,{statusCode:e.status,output:e.data.output,message:e.data.message,success:e.data.success}},function(e){return o.loader=!1,{error:e.data}})},DELETE:function(s){return o.loader=!0,e.delete(t+s).then(function(e){return o.loader=!1,{statusCode:e.status,output:e.data.output,message:e.data.message,success:e.data.success}})},_LOGIN:function(s,a){return o.loader=!0,e.post(t+s,a).then(function(e){return o.loader=!1,{success:e.data.success,message:e.data.message,token:e.data.token,user:e.data.user}},function(e){return o.loader=!1,{message:e.data.errors}})}}}]),app.factory("socket",["$timeout","$rootScope","socketURL",function(e,t,o){var s={},a=io.connect(o);return s.on=function(e,o){a.on(e,function(){var e=arguments;t.$apply(function(){o.apply(a,e)})})},s.emit=function(e,o,s){a.emit(e,o,function(){var e=arguments;t.$apply(function(){s&&s.apply(a,e)})})},s}]),app.factory("sortIcon",[function(){return{set:function(e){var t;return $(e.target).hasClass("fa-sort-alpha-asc")?($(".sort i").attr("class","fa fa-sort-alpha-asc"),$(e.target).removeClass("fa-sort-alpha-asc").addClass("fa-sort-alpha-desc"),t=1):($(".sort i").attr("class","fa fa-sort-alpha-asc"),$(e.target).addClass("fa-sort-alpha-asc").removeClass("fa-sort-alpha-desc"),t=0),t}}}]),app.factory("timeout",["$timeout",function(e){return{hundredMiliSeconds:function(t){e(function(){t()},100)},twoSecond:function(t){e(function(){t()},2e3)}}}]),app.factory("Toaster",["$mdToast","localStorageService","$mdDialog",function(e,t,o){return{simple:function(t,o){return o=o?"success":"error",e.show(e.simple().textContent(t).theme(o).position("top right").hideDelay(3e3))},saveUserSession:function(e){return e.remember?t.cookie.set("user_login",window.btoa(JSON.stringify(e)),e.expires):t.cookie.remove("user_login"),!0},getUserSession:function(e){return!!t.cookie.get("user_login")&&JSON.parse(window.atob(t.cookie.get("user_login")))},setSession:function(e){return e.expires?t.cookie.set("user",e,e.expires):t.cookie.set("user",e,1),t.cookie.get("user")},getSession:function(){return t.cookie.get("user")},updateProfileImage:function(e){var o=t.cookie.get("user");return o.user.image=e,this.setSession(o),this.getSession()},updateUserInfo:function(e){var o=t.cookie.get("user"),s=o.user.image;return o.user=e,o.user.image=s,this.setSession(o),this.getSession()},removeSession:function(){return t.cookie.remove("user"),!0},confirm:function(e){var t=o.confirm().title(e.title).textContent(e.message).ariaLabel("confirm").targetEvent(e.event).ok("Yes").cancel("No");return o.show(t)}}}]),app.factory("Top",["$mdToast",function(e){return{Scroll:function(){return $("html,body").animate({scrollTop:0},500)}}}]),app.controller("AppUserController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top","socket",function(e,t,o,s,a,n,i,r,l,c,u,d){n.query.type=["appraiser","inspector","trainee","apprentice"],n.query.order="_id",s.type?n.query.type=s.type:n.query.type="",a.list=function(){n.query.type||(n.query.type=["appraiser","inspector","trainee","apprentice"]),r.GET("list-users?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-user-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),d.emit("admin.blocked",{userId:a.selected},function(e){console.log(e)}),n.selected=[])})})}}]),app.controller("AddBenefitController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"benefits"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/benefits")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/benefits")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("BenefitController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="benefits",n.query.order="_id",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("EditBenefitController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/benefits"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/benefits")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/benefits")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("AddBlockController",["$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i){e.cms={type:"cms-block"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/blocks")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=n.upload({url:i+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/blocks")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("BlockController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="cms-block",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("EditBlockController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/blocks"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/blocks")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/blocks")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("AddBlogController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"blog"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/blogs")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/blogs")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("BlogController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="blog",n.query.order="_id",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("EditBlogController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/blogs"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/blogs")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/blogs")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("AddCommunityController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"community"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/community")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/community")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("CommunityController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="community",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("EditCommunityController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/community"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/community")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};console.log(t),angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/community")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("DashboardController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","$mdDateLocale","$httpParamSerializer",function(e,t,o,s,a,n,i,r,l,c){var u;a.currentDate=new Date,a.maxdate=new Date,a.graph={},a.graph.endDate=new Date,a.graph.startDate=moment().subtract(1,"months"),a.getDashboardInfo=function(){r.GET("get-dashboard-statistics",{}).then(function(e){a.dashboardInfo=e.output})},a.getJobsInfo=function(e){e&&(u=e.target.innerHTML,e.target.innerHTML="<i class='fa fa-spinner fa-spin'></i>"),r.GET("get-job-statistics",{}).then(function(t){a.jobList=t.output,e&&o(function(){e.target.innerHTML=u},300)})},a.getPaymentInfo=function(e){e&&(u=e.target.innerHTML,e.target.innerHTML="<i class='fa fa-spinner fa-spin'></i>"),r.GET("get-payment-statistics",{}).then(function(t){a.paymentList=t.output,e&&o(function(){e.target.innerHTML=u},300)})},a.suggestions=function(e){e&&(u=e.target.innerHTML,e.target.innerHTML="<i class='fa fa-spinner fa-spin'></i>"),n.query.order="created_at",r.GET("list-feedback?"+c(n.query)).then(function(t){a.suggestion=t.output,e&&o(function(){e.target.innerHTML=u},300)})},a.recentlyRegistered=function(e,t){t&&(u=t.target.innerHTML,
t.target.innerHTML="<i class='fa fa-spinner fa-spin'></i>"),r.GET("get-recently-registered?type="+e).then(function(e){a.recentlyRegisteredList=e.output,t&&o(function(){t.target.innerHTML=u},300)})},a.monthlyGraph=function(e){o(function(){a.isLoading=!0,r.GET("get-monthly-report",{request:e}).then(function(e){AmCharts.makeChart("graph",Object.assign(chat_options(),e.output)),o(function(){a.isLoading=!1},300)})},350)},a.getDashboardInfo(),a.getJobsInfo(),a.getPaymentInfo(),a.suggestions(),a.recentlyRegistered("company"),a.monthlyGraph(a.graph),Dashboard.init(),a.gone=function(e,t){e.$invalid||t&&a.monthlyGraph(t)}}]),app.directive("easypieChart",["$timeout",function(e){return{link:function(t,o){e(function(){o.easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:App.getBrandColor("yellow")})},500)}}}]),app.controller("ExportController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){var d=["jobs","category","payments"];if(s.id||i.path("/"),a.search=i.search(),s.id){var p=s.id.toLowerCase();d.indexOf(p)>=0?a.pageType=p:i.path("/")}i.search().category?a.query.category=i.search().category:delete a.query.category,i.search().appraisalRequest?a.query.appraisalRequest=i.search().appraisalRequest:delete a.query.appraisalRequest,i.search().startDate?a.query.startDate=i.search().startDate:delete a.query.startDate,i.search().endDate?a.query.endDate=i.search().endDate:delete a.query.endDate,a.attrs=function(){r.GET("job-attrs").then(function(e){a.attr=e.data})},a.attrs(),a.list=function(){console.log(a.query),r.GET("list-jobs?"+c(a.query)).then(function(e){a.data=e.output,a.csv=e.message,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on multiple rows?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.directive("jobFilter",function(){return{templateUrl:"backend/export/template/jobsFilter.html",controller:"filterJob"}}).controller("filterJob",["$scope","$location",function(e,t){e.searchResult=function(e,o){o&&t.search(o)}}]),app.controller("AddFaqController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"faq"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/faq")})}}]),app.controller("EditFaqController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/faq"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/faq")})}}]),app.controller("FaqController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="faq",n.query.order="_id",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("FeedbackController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.order="created_at",a.list=function(){r.GET("list-feedback?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-feedback?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-feedback-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})},s.id&&r.GET("get-feedback?id="+s.id).then(function(e){a.feedback=e.output})}]),app.controller("includeController",["$mdDialog","$cookies","$timeout","Upload","$routeParams","$scope","$rootScope","$location","REST",function(e,t,o,s,a,n,i,r,l){!function(){angular.isUndefined(t.get("clickedOn"))&&t.put("clickedOn",".dashboard"),o(function(){angular.element(document.querySelector(t.get("clickedOn"))).addClass("active"),angular.element(document.querySelector(t.get("subMenu"))).addClass("active")},500)}(),n.selectMainMenu=function(e){var s=e.currentTarget.className.split(" "),a="."+s[1];-1==s.indexOf("active")&&(t.put("clickedOn",a),$(".treeview").removeClass("active"),o(function(){$(a).addClass("active")},500))},n.selectSubmenu=function(e){var o=e.currentTarget.className.split(" "),s="."+o[0];$(".treeview-menu li").removeClass("active"),t.put("subMenu",s),$(s).addClass("active")},n.hideSubmenu=function(){$(".treeview-menu").slideUp("slow")},n.profilePage=function(){r.path("/admin/profile")},n.changePasswordPage=function(){r.path("/admin/change-password")},n.comingSoon=function(t){e.show(e.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Module is under development").textContent("").ariaLabel("Alert Dialog Demo").ok("Ok").targetEvent(t))}}]),app.controller("AddJobController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload","$httpParamSerializer",function(e,t,o,s,a,n,i,r){e.cms={type:"category"},t.query.type="category",t.query.order="title",e.listCategory=function(){s.GET("list-posts?"+r(t.query)).then(function(t){e.categories=t.output.records})},e.listCategory(),e.addCategory=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/jobs/category")})},e.addCategoryWithImage=function(s){if(!s)return void e.addCategory();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/jobs/category")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("EditJobController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path","$httpParamSerializer","$mdDialog",function(e,t,o,s,a,n,i,r,l,c,u){t.post_id||a.path("/jobs/category"),s.query.type="category",s.query.order="title",o.listCategory=function(){s.query.id=t.post_id,n.GET("with-parent?"+c(s.query)).then(function(e){o.categories=e.output.records})},o.listCategory(),o.getCategoryPost=function(){var e;if(t.post_id.search("_")>=0){var s=t.post_id.split("_");e="get-post?_pid="+s[0]+"&_sid="+s[1]}else e="get-post?_pid="+t.post_id;n.GET(e).then(function(e){e.success?(o.cms=e.output,"child"===e.output.editing&&(o.cms={parent:o.cms._id,_id:o.cms.children[0]._id,title:o.cms.children[0].title,shortDesc:o.cms.children[0].shortDesc,image:o.cms.children[0].image,status:o.cms.children[0].status}),o.cms&&!o.cms.parent&&(o.cms.parent="root")):a.path("/jobs/category")})},o.getCategoryPost(),o.removeSubCategory=function(e,t,s){var a=u.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(s).ok("Yes!").cancel("No");u.show(a).then(function(){n.DELETE("delete-post?post="+e+"&sub_post="+t).then(function(e){e.success&&o.getCategoryPost(),i.simple(e.message,e.success)})})},o.updateCategory=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/jobs/category")})},o.editCategoryWithImage=function(e){if(!e)return void o.updateCategory();var t={file:e};angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/jobs/category")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("JobController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="category",n.query.order="title",a.listCategory=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.listCategory(),a.removeCategory=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.listCategory(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.listCategory(),n.selected=[])})})}}]),app.controller("JobsController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){a.listJobs=function(){r.GET("listing-jobs?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.listJobs(),a.resetPage=function(){n.query.page=1},a.getAJob=function(){r.GET("get-single-job?_id="+s.id).then(function(e){a.job=e.output})},a.cancelJob=function(t,o){var s=e.confirm().title("Would you really like to cancel this contract?").ariaLabel("cancel Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("cancel-job?_id="+t).then(function(e){e.success&&a.getAJob(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.listJobs(),n.selected=[])})})},s.id&&a.getAJob()}]),app.controller("authController",["$scope","$location","REST","Toaster","$routeParams","$rootScope",function(e,t,o,s,a,n){e.form=1,e.login={remember:!1,expires:40},s.getUserSession()&&(e.login=s.getUserSession()),e.adminLogin=function(){e.isLoading=!0,o._LOGIN("login",e.login).then(function(o){e.isLoading=!1,o.success?(t.path("/dashboard"),e.login.remember&&(o.expires=e.login.expires),n.isLogin=s.setSession(o),s.saveUserSession(e.login)):s.simple(o.message,!1)})},e.forgotPassword=function(){o.POST("forgot",e.forgot).then(function(t){e.forgot=null,e.forgotForm.$setPristine(),e.forgotForm.$setUntouched(),s.simple(t.message,t.success)})},a.reset||(e.nokey=!0),e.resetPassword=function(){e.reset.key=a.reset,o.POST("reset",e.reset).then(function(e){s.simple(e.message,e.success),e.success&&t.path("/login")})}}]),app.controller("AddLinkController",["$scope","$rootScope","$location","REST","Toaster",function(e,t,o,s,a){e.cms={type:"link"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/links")})}}]),app.controller("EditLinkController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster",function(e,t,o,s,a,n,i){t.post_id||a.path("/links"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/links")})}}]),app.controller("LinkController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="link",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("EditManagerController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster",function(e,t,o,s,a,n,i){t.manager_id||a.path("/managers"),o.getUser=function(){n.GET("get-manager?_mid="+t.manager_id).then(function(e){o.admin=e.output})},o.getUser(),o.updateUser=function(){delete o.admin.created_at,delete o.admin.updated_at,n.POST("update-member?_mid="+o.admin._id,o.admin).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/managers")})}}]),app.controller("ManagerController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){a.listUsers=function(){r.GET("list-managers?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.listUsers(),a.addUser=function(){r.POST("add-user",a.admin).then(function(e){l.simple(e.message,e.success),e.success&&i.path("/managers")})},a.removeUser=function(t,o){var s=e.confirm().title("Would you really like to delete this user?").ariaLabel("Remove Admin User").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-manager?manager="+t).then(function(e){e.success&&a.listUsers(),l.simple(e.message,e.success)})})},a.quickAction=function(e){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);r.POST("quick-action",{type:e,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&a.listUsers()})}}]),app.controller("AddPageController",["$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i){e.cms={type:"page"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/pages")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=n.upload({url:i+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/pages")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("EditPageController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/pages"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/pages")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/pages")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("PageController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="page",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("PaymentController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.order="title",a.listPayments=function(){r.GET("list-payments?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.listPayments(),a.paymentDetails=function(){r.GET("get-payment?_id="+s.id).then(function(e){a.charge=e.output})},s.id&&a.paymentDetails(),a.refundPayment=function(t){if(!a.charge)return!1;var o=e.confirm().title("Would you really like to refund amount?").ariaLabel("Refund Payment").targetEvent(t).ok("Yes!").cancel("No");e.show(o).then(function(){r.POST("refund-payment",{chargeId:a.charge.chargeId,Identifier:a.charge.meta.Identifier}).then(function(e){a.paymentDetails(),l.simple(e.message,e.success)})})},a.transferPayment=function(t){if(!a.charge)return!1;var o=e.confirm().title("Would you really like to transfer amount?").ariaLabel("Refund Payment").targetEvent(t).ok("Yes!").cancel("No");e.show(o).then(function(){r.POST("transfer-payment",{chargeId:a.charge.chargeId,Identifier:a.charge.meta.Identifier}).then(function(e){a.paymentDetails(),l.simple(e.message,e.success)})})}}]),app.controller("ProfileController",["Upload","$routeParams","$scope","$rootScope","$location","REST","Toaster","$mdDialog","api_path",function(e,t,o,s,a,n,i,r,l){function c(){n.GET("profile-info").then(function(e){o.user=e.output})}o.tab=t.tab,c(),o.updateProfile=function(){o.isLoading=!0,n.POST("update-profile",o.user).then(function(e){o.isLoading=!1,e.success&&(s.isLogin=i.updateUserInfo(o.user)),i.simple(e.message,e.success)})},o.changePassword=function(){var e={currentPassword:o.user.old,password:o.user.new,_id:o.user._id};o.user.confirm===o.user.new?n.POST("changePassword",e).then(function(e){e.success&&(o.user.new=null,o.user.old=null,o.user.confirm=null,o.passwordForm.$setPristine(),o.passwordForm.$setUntouched()),i.simple(e.message,e.success)}):i.simple("Confirm password must be same as New Password",!1)},o.myImage="",o.myCroppedImage="",o.aspectRatio=2.8,o.selectFile=function(e,t){if(e){var s=["image/jpeg","image/jpg","image/png"];if(e&&-1===s.indexOf(e.type))return void i.simple("You can only upload image having file extension jpg, jpeg or png",!1);self.filename=e?e.name:"";var a=new FileReader;a.onload=function(e){o.$apply(function(o){o.myImage=e.target.result,t&&o.cropImagePopup()})},a.readAsDataURL(e)}},o.cropImagePopup=function(){r.show({contentElement:"#imageDialog",parent:angular.element(document.body),clickOutsideToClose:!0})},o.closeDialog=function(){o.myImage="",o.myCroppedImage="",r.hide()},o.uploadProfileImage=function(t,o){var a={dataUrl:t,imageName:self.filename};e.upload({url:l+"update-profile-image",data:{file:e.dataUrltoBlob(a.dataUrl,a.imageName)}}).then(function(e){s.closeDialog(),s.isLogin=i.updateProfileImage(e.data.output),e.data.success&&c()})}}]),app.controller("SettingController",["$scope","$location","REST","Toaster","$parse","$mdDialog","Upload","api_path","$rootScope",function(e,t,o,s,a,n,i,r,l){o.GET("get-settings").then(function(t){if(t.success){var o,s,n,i,r;for(o=0;o<t.output.length;o++)s=t.output[o].meta_key,n=t.output[o].meta_value,i="settings."+s,r=a(i),r.assign(e,n)}}),e.updateSettings=function(){o.PUT("update-settings",e.settings).then(function(e){e.success&&s.simple(e.message,!0)})},e.myImage="",e.myCroppedImage="",e.aspectRatio=0,e.selectFile=function(t,o){var a=["image/jpeg","image/jpg","image/png"];if(t&&-1===a.indexOf(t.type))return void s.simple("You can only upload image having file extension jpg, jpeg or png",!1);self.filename=t?t.name:"";var n=new FileReader;n.onload=function(t){e.$apply(function(e){e.myImage=t.target.result,o&&e.cropImagePopup()})},n.readAsDataURL(t)},e.cropImagePopup=function(){n.show({contentElement:"#imageDialog",parent:angular.element(document.body),clickOutsideToClose:!0})},e.uploadProfileImage=function(e,t){var o={dataUrl:e,imageName:self.filename};i.upload({url:r+"update-logo",data:{file:i.dataUrltoBlob(o.dataUrl,o.imageName)}}).then(function(e){console.log(e),l.closeDialog()})}}]),app.controller("AddSitemapController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload","$httpParamSerializer",function(e,t,o,s,a,n,i,r){e.listlinks=function(){s.GET("list-sitemap?"+r(t.query)).then(function(t){e.data=t.output})},e.listlinks(),e.add=function(){s.POST("add-sitemap-link",e.cms).then(function(e){a.simple(e.message,e.success),e.success})}}]),app.controller("EditSitemapController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path","$httpParamSerializer","$mdDialog","Top",function(e,t,o,s,a,n,i,r,l,c,u,d){t.post_id||a.path("/sitemap"),o.listlinks=function(){n.GET("list-sitemap?"+c(s.query)).then(function(e){o.data=e.output,d.Scroll()})},o.listlinks(),o.getMapLink=function(){n.GET("get-map-link?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getMapLink(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-sitemap?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/sitemap")})},o.removeEmLink=function(e,t,s){var a=u.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(s).ok("Yes!").cancel("No");u.show(a).then(function(){n.DELETE("remove-sitemap-link?id="+e+"&post="+t+"&em=1").then(function(e){e.success&&(o.getMapLink(),d.Scroll()),i.simple(e.message,e.success)})})},o.addLink=function(){n.POST("add-sitemap-link?linkonly=1",o.cms).then(function(e){i.simple(e.message,e.success),e.success&&(delete o.cms.link,delete o.cms.url,o.getMapLink(),d.Scroll())})}}]),app.controller("SitemapController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){a.listlinks=function(){r.GET("list-sitemap?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.listlinks(),a.sync=function(){r.GET("sync-sitemap").then(function(e){a.listlinks()})},a.removeLink=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("remove-sitemap-link?post="+t).then(function(e){e.success&&a.listlinks(),l.simple(e.message,e.success)})})}}]),app.controller("AddSliderController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"slider"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/slider")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/slider")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("EditSliderController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/slider"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/slider")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};console.log(t),angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/slider")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("SliderController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="slider",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("AddTestimonialController",["$scope","$rootScope","$location","REST","Toaster","api_path","Upload",function(e,t,o,s,a,n,i){e.cms={type:"testimonial"},e.add=function(){s.POST("add-post",e.cms).then(function(e){a.simple(e.message,e.success),e.success&&o.path("/testimonials")})},e.addWithImage=function(s){if(!s)return void e.add();var r={file:s};angular.merge(r,e.cms),t.loader=!0,s.upload=i.upload({url:n+"add-post-with-file",data:r}),s.upload.then(function(e){t.loader=!1,a.simple(e.data.message,e.data.success),e.data.success&&o.path("/testimonials")},function(o){t.loader=!1,o.status>0&&(e.errorMsg=o.status+": "+o.data)},function(e){s.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]),app.controller("EditTestimonialController",["$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","Upload","api_path",function(e,t,o,s,a,n,i,r,l){t.post_id||a.path("/testimonials"),o.getPost=function(){n.GET("get-post?_pid="+t.post_id).then(function(e){o.cms=e.output})},o.getPost(),o.update=function(){delete o.cms.created_at,delete o.cms.updated_at,n.POST("update-post?_pid="+o.cms._id,o.cms).then(function(e){i.simple(e.message,e.success),e.success&&a.path("/testimonials")})},o.editWithImage=function(e){if(!e)return void o.update();var t={file:e};console.log(t),angular.merge(t,o.cms),s.loader=!0,e.upload=r.upload({url:l+"edit-post-with-file",data:t}),e.upload.then(function(e){s.loader=!1,i.simple(e.data.message,e.data.success),e.data.success&&a.path("/testimonials")},function(e){s.loader=!1,e.status>0&&(o.errorMsg=e.status+": "+e.data)},function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}]),app.controller("TestimonialController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top",function(e,t,o,s,a,n,i,r,l,c,u){n.query.type="testimonial",n.query.order="title",a.list=function(){r.GET("list-posts?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.remove=function(t,o){var s=e.confirm().title("Would you really like to delete this record?").ariaLabel("Delete Record").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.DELETE("delete-post?post="+t).then(function(e){e.success&&a.list(),l.simple(e.message,e.success)})})},a.quickAction=function(t,o){if(!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-post-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),n.selected=[])})})}}]),app.controller("addEditUserCtrl",["$timeout","toastyService","$rootScope","http","$scope","$location","$routeParams",function(e,t,o,s,a,n,i){function r(){i.id&&s.get("/admin/user-detail-by-id?id="+i.id).then(function(e){a.user=e.result})}!function(){r()}(),a.signUp=function(){s.post("/admin/user-registration",a.user).then(function(e){t.notification(e.result.success,e.result.message),e.result.success&&n.path("/admin/users")})},a.updateUser=function(){s.post("/admin/update-user",a.user).then(function(e){t.notification(e.result.success,e.result.msg),e.result.success&&n.path("/admin/users")})},a.placeChanged=function(){a.place=this.getPlace();var e=formatted_address(a.place.address_components);console.log(a.place),a.userSignInfo.state=e.state,a.userSignInfo.subrub=a.place.vicinity,a.userSignInfo.address=e.address,a.userSignInfo.zip_code=e.postal_code,a.userSignInfo.lat=JSON.parse(JSON.stringify(a.place.geometry.location)).lat,a.userSignInfo.lng=JSON.parse(JSON.stringify(a.place.geometry.location)).lng,a.userSignInfo.coordinates=[a.userSignInfo.lng,a.userSignInfo.lat]}}]),app.controller("userController",["toastyService","confirmationDialog","$rootScope","defaultSortType","sortIcon","http","$scope","$location","$routeParams","paging",function(e,t,o,s,a,n,i,r,l,c){function u(){var e=r.path().split("/");i.lastIndex=e[e.length-1],
"service-providers"==i.lastIndex?i.userType="Service Provider":"customers"==i.lastIndex&&(i.userType="Customer")}function d(e,t){var o;e?o=e:(o="created_at",t=s);var a=angular.isDefined(i.paging)?i.paging.page:1;n.get("/admin/user-list?type="+i.lastIndex+"&page="+a+"&sortBy="+o+"&sortType="+t).then(function(e){i.data=e,i.paging=e.paging})}function p(e){var t=angular.isDefined(e)?e:i.paging.page;r.search("page",t)}!function(){setTimeout(function(){var e=l.page?l.page:1;i.paging={page:e},d()},10),i.forceEllipses=c.forceEllipses,i.maxSize=c.maxSize,u()}(),i.redirectTo=function(e,t){r.path(e+t)},i.search=function(e){if(angular.isUndefined(i.searchFor))i.paging={page:1},p(),d();else{"getmore"!==e&&(i.paging={page:1},p());var t=angular.isDefined(i.paging)?i.paging.page:1;n.get("/admin/search-user?user="+i.lastIndex+"&page="+t+"&search="+i.searchFor).then(function(e){i.data=e,i.paging=e.paging})}},i.getMoreRecord=function(){angular.isDefined(i.searchFor)?i.search("getmore"):d(),p()},i.addNew=function(e){r.path(e)},i.signUp=function(){},i.sort=function(e,t,o){var s;s=1===a.set(o)?1:-1,"status"==t&&(s*=-1),d(t,s)},i.trash=function(o,s,a){t.confirm(a,function(t){t.then(function(){n.post("/admin/temp-remove-user/"+o).then(function(t){e.notification(t.result.success,t.result.msg),t.result.success&&i.data.result.splice(s,1)})},function(){})})}}]),app.controller("WebUserController",["$mdDialog","$cookies","$timeout","$routeParams","$scope","$rootScope","$location","REST","Toaster","$httpParamSerializer","Top","socket",function(e,t,o,s,a,n,i,r,l,c,u,d){n.query.type=["company","individual"],n.query.order="_id",s.type?n.query.type=s.type:n.query.type="",d.emit("admin.blocked",{userId:["1","2"]},function(e){console.log(e)}),a.list=function(){n.query.type||(n.query.type=["company","individual"]),r.GET("list-users?"+c(n.query)).then(function(e){a.data=e.output,u.Scroll()})},a.list(),a.quickAction=function(t,o){if(console.log(a.selected),!a.selected.length)return void l.simple("Please choose some records first.",!1);var s=e.confirm().title("Would you really want to perform this action on selected row(s)?").ariaLabel("Quick Action").targetEvent(o).ok("Yes!").cancel("No");e.show(s).then(function(){r.POST("quick-user-action",{type:t,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(a.list(),d.emit("admin.blocked",{userId:a.selected},function(e){console.log(e)}),n.selected=[])})})},a.addUser=function(){r.POST("add-web-user",a.user).then(function(e){l.simple(e.message,e.success),e.success&&(a.user={},a.userForm.$setPristine(),a.userForm.$setUntouched())})},a.updateUser=function(){var e="active";console.log(a.user.status,typeof a.user.status),a.user.status&&"false"!=a.user.status&&0!=a.user.status||(e="inactive"),a.selected.push(a.user._id),r.POST("quick-user-action",{type:e,on:a.selected}).then(function(e){l.simple(e.message,e.success),e.success&&(d.emit("admin.blocked",{userId:a.selected},function(e){}),n.selected=[])})},s.id&&r.GET("get-user?_id="+s.id).then(function(e){a.user=e.output})}]),app.directive("ascIcon",["$compile",function(e){return{restrict:"A",link:function(e,t,o){t.addClass("fa fa-sort-alpha-asc")}}}]),app.directive("fallbackSrc",function(){return{link:function(e,t,o){t.bind("error",function(){angular.element(this).attr("src",o.fallbackSrc)})}}}).directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,o,s){s.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^0-9]/g,"");return t!=e&&(s.$setViewValue(t),s.$render()),t})}}}).directive("setHeight",["$window",function(e){return{restrict:"A",link:function(t,o,s){o.css("min-height",e.innerHeight-50+"px")}}}]).directive("backButton",function(){return{restrict:"A",link:function(e,t,o){t.on("click",function(){history.back(),e.$apply()})}}}).directive("materialLoader",function(){return{restrict:"E",template:'<div class="load-container" layout="column" layout-align="center center"><md-progress-circular md-mode="indeterminate"></md-progress-circular></div>'}}).directive("noRecords",function(){return{restrict:"E",template:'<div class="no-records" layout="column" layout-align="center center"><i class="fa fa-frown-o fa-200x hideGrey"></i></div>'}}).directive("passwordVerify",passwordVerify),app.filter("cut",function(){return function(e,t,o,s){if(!e)return"";if(!(o=parseInt(o,10)))return e;if(e.length<=o)return e;if(e=e.substr(0,o),t){var a=e.lastIndexOf(" ");-1!==a&&("."!==e.charAt(a-1)&&","!==e.charAt(a-1)||(a-=1),e=e.substr(0,a))}return e+(s||" ...")}}),app.filter("unique",function(){return function(e,t){var o=[],s=[];return angular.forEach(e,function(e){var a=e[t];-1===s.indexOf(a)&&(s.push(a),o.push(e))}),o}});